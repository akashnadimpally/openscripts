# Use the base image
FROM node:18-bullseye-slim AS builder

# Set up cache mounts for apt
RUN --mount=type=cache,target=/var/cache/apt --mount=type=cache,target=/var/lib/apt \
    echo "" > /etc/apt/sources.list && \
    echo 'Acquire::https::Verify-Peer "false";' >> /etc/apt/apt.conf.d/80ssl-exceptions && \
    echo "deb https://artifactory.com/artifactory/remote-debian-archive bookworm main" > /etc/apt/sources.list.d/artifactory.list

# Update and install required packages
RUN --mount=type=cache,target=/var/cache/apt --mount=type=cache,target=/var/lib/apt \
    apt-get update && \
    apt-get install -y --no-install-recommends \
        python3 \
        g++ \
        build-essential \
        python3-pip \
        python3-venv \
        wget \
        unzip && \
    rm -rf /var/lib/apt/lists/*

# Continue with other instructions
